---
phase: 10-backend-updates
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/shared/src/types/database.ts
  - packages/shared/src/services/exercises.ts
autonomous: true

must_haves:
  truths:
    - "Exercise type includes is_system, instructions, level, force, mechanic fields"
    - "ExerciseCategory includes 'Other' option"
    - "getCategories returns 7 categories including 'Other'"
    - "createExercise explicitly sets is_system=false"
  artifacts:
    - path: "packages/shared/src/types/database.ts"
      provides: "Updated Exercise interface with system exercise fields"
      contains: "is_system: boolean"
    - path: "packages/shared/src/services/exercises.ts"
      provides: "Updated exercise service with explicit is_system handling"
      contains: "is_system: false"
  key_links:
    - from: "packages/shared/src/services/exercises.ts"
      to: "packages/shared/src/types/database.ts"
      via: "Exercise type import"
      pattern: "import.*Exercise.*from"
---

<objective>
Update TypeScript types and service functions to support system exercises alongside user exercises.

Purpose: Align TypeScript types with database schema changes from Phase 8, ensuring type safety for the new system exercise fields.
Output: Updated Exercise interface with new fields, ExerciseCategory with 'Other', and createExercise explicitly setting is_system=false.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-backend-updates/10-CONTEXT.md

# Prior work reference
@.planning/phases/08-database-schema-migration/08-01-SUMMARY.md

# Files to modify
@packages/shared/src/types/database.ts
@packages/shared/src/services/exercises.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Exercise type and ExerciseCategory</name>
  <files>packages/shared/src/types/database.ts</files>
  <action>
Update the types to match the database schema from Phase 8:

1. Update ExerciseCategory union type to include 'Other':
```typescript
export type ExerciseCategory =
  | 'Chest'
  | 'Back'
  | 'Shoulders'
  | 'Legs'
  | 'Arms'
  | 'Core'
  | 'Other';
```

2. Update Exercise interface to add new fields (all nullable except is_system):
```typescript
export interface Exercise {
  id: string;
  user_id: string | null;
  name: string;
  category: ExerciseCategory;
  equipment: string | null;
  // New fields from Phase 8 schema migration
  instructions: string[] | null;
  level: 'beginner' | 'intermediate' | 'expert' | null;
  force: 'push' | 'pull' | 'static' | null;
  mechanic: 'compound' | 'isolation' | null;
  is_system: boolean;
}
```

Keep existing JSDoc comments. Add brief comments for the new fields matching the style of existing comments.
  </action>
  <verify>Run `pnpm -C packages/shared exec tsc --noEmit` to verify no type errors</verify>
  <done>Exercise type has is_system boolean and nullable instructions/level/force/mechanic fields; ExerciseCategory includes 'Other'</done>
</task>

<task type="auto">
  <name>Task 2: Update exercises service for system exercises</name>
  <files>packages/shared/src/services/exercises.ts</files>
  <action>
Make two updates to the exercises service:

1. Update getCategories() to include 'Other':
```typescript
function getCategories(): ExerciseCategory[] {
  return ['Chest', 'Back', 'Shoulders', 'Legs', 'Arms', 'Core', 'Other'];
}
```

2. Update createExercise() insert to explicitly set is_system=false:
```typescript
const { data, error } = await supabase
  .from('exercises')
  .insert([
    {
      user_id: user.id,
      name: name.trim(),
      category: category,
      equipment: equipment ? equipment.trim() : null,
      is_system: false,  // User-created exercises are never system exercises
    },
  ])
  .select()
  .single();
```

Add a brief inline comment for is_system explaining why it's explicitly false.
  </action>
  <verify>Run `pnpm -C packages/shared exec tsc --noEmit` to verify no type errors</verify>
  <done>getCategories returns 7 categories including 'Other'; createExercise explicitly sets is_system=false</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. TypeScript compilation passes: `pnpm -C packages/shared exec tsc --noEmit`
2. Verify Exercise type has all new fields by checking database.ts
3. Verify getCategories includes 'Other' by checking exercises.ts
4. Verify createExercise sets is_system=false by checking exercises.ts

Note: getExercises already returns all exercises and relies on RLS to filter. No changes needed (BACK-02 satisfied by Phase 8 RLS policies).
</verification>

<success_criteria>
- Exercise interface has: is_system (boolean), instructions (string[] | null), level (union | null), force (union | null), mechanic (union | null)
- ExerciseCategory type includes 'Other' as seventh option
- getCategories() returns array with 7 elements including 'Other'
- createExercise() insert object includes `is_system: false`
- TypeScript compilation passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-backend-updates/10-01-SUMMARY.md`
</output>
