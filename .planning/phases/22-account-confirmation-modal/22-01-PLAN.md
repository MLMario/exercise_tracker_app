---
phase: 22-account-confirmation-modal
plan: 01
type: execute
depends_on: []
files_modified: [src/components/InfoModal.tsx, src/surfaces/auth/AuthSurface.tsx]
domain: preact
---

<objective>
Replace green success toast with email confirmation modal after account creation.

Purpose: Improve UX by clearly communicating that email confirmation is required to activate the account.
Output: InfoModal component and updated AuthSurface registration flow.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

# Modal pattern reference:
@src/components/ConfirmationModal.tsx

# File to modify:
@src/surfaces/auth/AuthSurface.tsx

**Established patterns:**
- Modal structure: modal-overlay > modal modal-sm > modal-header/body/footer
- Click overlay to close, stopPropagation on modal content
- Preact functional components with TypeScript interfaces
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create InfoModal component</name>
  <files>src/components/InfoModal.tsx</files>
  <action>Create InfoModal component following ConfirmationModal pattern but for informational messages with single action button. Props: isOpen, title, message (can be JSX for multi-paragraph), buttonLabel, onClose. Structure: modal-overlay > modal modal-sm > modal-header (h2 title) > modal-body (message content) > modal-footer (single primary button). Use same click-overlay-to-close pattern. Export both named and default.</action>
  <verify>File exists at src/components/InfoModal.tsx, no TypeScript errors</verify>
  <done>InfoModal component created with isOpen/title/message/buttonLabel/onClose props, renders modal with single action button</done>
</task>

<task type="auto">
  <name>Task 2: Integrate InfoModal into AuthSurface for registration</name>
  <files>src/surfaces/auth/AuthSurface.tsx</files>
  <action>Import InfoModal. Add state `showEmailConfirmModal` (boolean, default false). In handleAuth success for register case (around line 219-223): instead of setSuccessMessage, set showEmailConfirmModal to true and clear form fields. Render InfoModal with: isOpen={showEmailConfirmModal}, title="Check Your Email", message explaining they need to click the confirmation link, buttonLabel="Got it", onClose that sets showEmailConfirmModal to false and optionally switches to login surface. Remove or keep the existing successMessage display for login success (login doesn't need email confirmation).</action>
  <verify>npm run build succeeds, manual test: register new account -> modal appears instead of green toast</verify>
  <done>Registration success shows InfoModal with email confirmation instructions instead of green success toast</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] No TypeScript errors
- [ ] Registration flow: submit -> modal appears explaining email confirmation
- [ ] Modal dismisses on button click or overlay click
- [ ] Login success still works (shows green toast or silent, depending on preference)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- InfoModal component reusable for future informational dialogs
- Registration UX clearly communicates email confirmation requirement
</success_criteria>

<output>
After completion, create `.planning/phases/22-account-confirmation-modal/22-01-SUMMARY.md`
</output>
