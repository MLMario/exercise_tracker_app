---
phase: 24-workout-detail-surface
plan: 02
type: gap_closure
source: 24-UAT.md
---

# Phase 24 Plan 02: Fix Workout Title Display

**Goal:** Display template name in workout detail header instead of hardcoded "Untitled Workout"

## Gap Being Closed

- **Truth:** Workout detail header displays the template name of the logged workout
- **Current:** Title shows "Untitled Workout" for all workouts
- **Root cause:** `getWorkoutLog` service method doesn't join templates table; `WorkoutLogWithExercises` type missing `template_name`

## Tasks

### Task 1: Add template_name to WorkoutLogWithExercises type

**File:** `packages/shared/src/types/database.ts`

**Change:** Add optional `template_name` property to `WorkoutLogWithExercises` interface

```typescript
// Line 330-332, update to:
export interface WorkoutLogWithExercises extends Omit<WorkoutLog, 'user_id'> {
  template_name?: string | null;
  workout_log_exercises: WorkoutLogExerciseWithSets[];
}
```

**Commit:** `fix(24): add template_name to WorkoutLogWithExercises type`

### Task 2: Update getWorkoutLog to join templates table

**File:** `packages/shared/src/services/logging.ts`

**Change:** Add `templates (name)` to the select query in `getWorkoutLog` function

```typescript
// Line 237-261, update to include templates join:
const { data, error } = await supabase
  .from('workout_logs')
  .select(
    `
    id,
    template_id,
    started_at,
    created_at,
    templates (name),
    workout_log_exercises (
      id,
      exercise_id,
      rest_seconds,
      order,
      exercises (
        id,
        name,
        category
      ),
      workout_log_sets (
        id,
        set_number,
        weight,
        reps,
        is_done
      )
    )
  `
  )
  .eq('id', id)
  .single();
```

**Also add:** After line 271 (after casting to WorkoutLogWithExercises), extract template_name:

```typescript
// After: const result = data as unknown as WorkoutLogWithExercises;
// Add template_name from joined data
result.template_name = (data as any).templates?.name || null;
```

**Commit:** `fix(24): include template name in getWorkoutLog query`

### Task 3: Use template_name in WorkoutDetail component

**File:** `apps/web/src/surfaces/dashboard/WorkoutDetail.tsx`

**Change:** Line 81, replace hardcoded "Untitled Workout" with dynamic template name

```tsx
// Line 81, update from:
<h2 class="workout-detail-title">Untitled Workout</h2>

// To:
<h2 class="workout-detail-title">{workout.template_name || 'Untitled Workout'}</h2>
```

**Commit:** `fix(24): display template name in workout detail header`

## Verification

After all tasks complete:
1. Navigate to Settings > Exercise History
2. Tap on a logged workout that was created from a template
3. Verify the header shows the template name (e.g., "Push Day") instead of "Untitled Workout"
4. Verify workouts without templates still show "Untitled Workout"

## Files Modified

- `packages/shared/src/types/database.ts` - Add template_name to type
- `packages/shared/src/services/logging.ts` - Join templates table in query
- `apps/web/src/surfaces/dashboard/WorkoutDetail.tsx` - Display template name
