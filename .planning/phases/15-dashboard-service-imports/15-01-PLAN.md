---
phase: 15-dashboard-service-imports
plan: 01
type: execute
depends_on: []
files_modified:
  - src/surfaces/dashboard/DashboardSurface.tsx
  - src/surfaces/dashboard/ChartCard.tsx
---

<objective>
Update DashboardSurface.tsx and ChartCard.tsx to use direct TypeScript service imports instead of window globals.

Purpose: Continue legacy code cleanup by removing window.* service dependencies from dashboard components.
Output: Both files import services from @/services barrel and all window.* service calls are replaced.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-workout-service-imports/14-01-SUMMARY.md

**Established pattern from Phase 14:**
- Import services: `import { exercises, templates, logging, charts } from '@/services';`
- Replace `window.serviceName.method()` with `serviceName.method()`
- If local variable shadows service name, rename the local variable

**Services available via @/services:**
- exercises, templates, logging, charts (all needed for dashboard)

**Files to update:**

1. **DashboardSurface.tsx** - 7 window.* calls:
   - Line 106: `window.templates.getTemplates()`
   - Line 116: `window.exercises.getExercises()`
   - Line 131: `window.charts.getUserCharts()`
   - Lines 144-146: `window.logging.getExerciseMetrics()`
   - Line 271: `window.templates.deleteTemplate()`
   - Lines 344-348: `window.charts.createChart()`
   - Line 404: `window.charts.deleteChart()`

2. **ChartCard.tsx** - 2 window.* calls:
   - Lines 144-151: `window.charts.renderChart()`
   - Line 175: `window.charts.destroyChart()`
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update DashboardSurface.tsx to use direct service imports</name>
  <files>src/surfaces/dashboard/DashboardSurface.tsx</files>
  <action>
1. Add import at top of file after existing imports:
   `import { exercises, templates, logging, charts } from '@/services';`

2. Replace all 7 window.* service calls:
   - Line 106: `window.templates.getTemplates()` → `templates.getTemplates()`
   - Line 116: `window.exercises.getExercises()` → `exercises.getExercises()`
   - Line 131: `window.charts.getUserCharts()` → `charts.getUserCharts()`
   - Lines 144-146: `window.logging.getExerciseMetrics(...)` → `logging.getExerciseMetrics(...)`
   - Line 271: `window.templates.deleteTemplate(id)` → `templates.deleteTemplate(id)`
   - Lines 344-348: `window.charts.createChart({...})` → `charts.createChart({...})`
   - Line 404: `window.charts.deleteChart(id)` → `charts.deleteChart(id)`

Note: Check for any local variable naming conflicts with imported service names. The file uses `templates` state variable (line 62) - this is fine because the import is a different scope level.
  </action>
  <verify>npm run build passes without TypeScript errors</verify>
  <done>DashboardSurface.tsx imports from @/services and has 0 window.* service calls</done>
</task>

<task type="auto">
  <name>Task 2: Update ChartCard.tsx to use direct service imports</name>
  <files>src/surfaces/dashboard/ChartCard.tsx</files>
  <action>
1. Add import at top of file after existing imports:
   `import { charts } from '@/services';`

2. Replace both window.* service calls:
   - Lines 144-151: `window.charts.renderChart(...)` → `charts.renderChart(...)`
   - Line 175: `window.charts.destroyChart(...)` → `charts.destroyChart(...)`
  </action>
  <verify>npm run build passes without TypeScript errors</verify>
  <done>ChartCard.tsx imports from @/services and has 0 window.* service calls</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] No remaining window.templates, window.exercises, window.logging, or window.charts calls in modified files
- [ ] App still works (dashboard loads, charts render, templates display)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors introduced
- DashboardSurface.tsx and ChartCard.tsx use direct service imports
- Phase 15 complete
</success_criteria>

<output>
After completion, create `.planning/phases/15-dashboard-service-imports/15-01-SUMMARY.md`
</output>
