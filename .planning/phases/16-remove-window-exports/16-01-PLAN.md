---
phase: 16-remove-window-exports
plan: 01
type: execute
depends_on: []
files_modified:
  - src/services/auth.ts
  - src/services/charts.ts
  - src/services/templates.ts
  - src/services/exercises.ts
  - src/services/logging.ts
  - src/env.d.ts
---

<objective>
Remove all window.* exports from TypeScript services now that all consumers use direct imports.

Purpose: Complete the migration from legacy window globals to proper TypeScript modules.
Output: Clean TypeScript services without window namespace pollution.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-dashboard-service-imports/15-01-SUMMARY.md

**Prior work:** Phases 14-15 migrated all Preact components to use direct service imports.
All window.* service calls have been replaced - these exports are now dead code.

**Scope boundary:** `window.supabaseClient` in src/lib/supabase.ts is NOT removed here - that's Phase 17.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove window exports from service files</name>
  <files>src/services/auth.ts, src/services/charts.ts, src/services/templates.ts, src/services/exercises.ts, src/services/logging.ts</files>
  <action>
Remove the window.* export line from the end of each service file:
- auth.ts line 295: delete `window.auth = auth;`
- charts.ts line 421: delete `window.charts = charts;`
- templates.ts line 738: delete `window.templates = templates;`
- exercises.ts line 234: delete `window.exercises = exercises;`
- logging.ts line 645: delete `window.logging = logging;`

Each file has exactly one line to remove at the end of the file.
Do NOT remove window.location usage in auth.ts (line 144) - that's a legitimate browser API call.
  </action>
  <verify>npm run build succeeds with no TypeScript errors</verify>
  <done>All 5 service files no longer export to window namespace</done>
</task>

<task type="auto">
  <name>Task 2: Remove Window interface augmentation from env.d.ts</name>
  <files>src/env.d.ts</files>
  <action>
Remove the legacy Window augmentation from env.d.ts:
1. Remove the type imports at lines 3-8 (TemplatesService, ExercisesService, LoggingService, ChartsService)
2. Remove the entire declare global block (lines 19-35) that augments the Window interface

Keep: The vite reference, ImportMetaEnv interface, and ImportMeta interface.

Final file should only contain:
- vite/client reference
- ImportMetaEnv interface (VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY)
- ImportMeta interface
  </action>
  <verify>npm run build succeeds, no type errors related to Window interface</verify>
  <done>env.d.ts contains only Vite environment types, no Window augmentation</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] No TypeScript errors in IDE
- [ ] `npm run preview` - app loads and functions normally
- [ ] grep confirms no `window.(auth|charts|templates|exercises|logging) =` patterns remain in src/
</verification>

<success_criteria>

- All 5 service window exports removed
- Window interface augmentation removed from env.d.ts
- Build passes with no errors
- App functionality unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/16-remove-window-exports/16-01-SUMMARY.md`
</output>
