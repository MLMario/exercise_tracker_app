---
phase: 17-remove-legacy-files
plan: 01
type: execute
depends_on: []
files_modified: [index.html, vite.config.ts]
---

<objective>
Update HTML and build config to stop loading and copying legacy JS files.

Purpose: First step of legacy removal - stop referencing JS files before deleting them.
Output: Clean index.html without legacy script tags, vite.config.ts without JS static-copy.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/16-remove-window-exports/16-01-SUMMARY.md

**Prior phase completed:**
- Phase 16 removed all window.* exports from TypeScript services
- All Preact components now use direct ES module imports
- Legacy JS files are no longer accessed via window globals

**Files to modify:**
@index.html
@vite.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove legacy JS script tags from index.html</name>
  <files>index.html</files>
  <action>
Remove the 6 script tags that load legacy JS services (lines 17-24):
- Remove comment "Service Modules (used by Preact surfaces via window.*)"
- Remove: `<script src="js/auth.js"></script>`
- Remove: `<script src="js/exercises.js"></script>`
- Remove: `<script src="js/templates.js"></script>`
- Remove: `<script src="js/logging.js"></script>`
- Remove: `<script src="js/timer.js"></script>`
- Remove: `<script src="js/charts.js"></script>`

Keep: Chart.js CDN script (line 15) - still used by chart rendering.
Keep: Vite entry point script (line 27) - the main app entry.
  </action>
  <verify>grep -c "js/auth.js\|js/exercises.js\|js/templates.js\|js/logging.js\|js/timer.js\|js/charts.js" index.html returns 0</verify>
  <done>index.html has no script tags referencing js/*.js files, only Chart.js CDN and Vite entry point remain</done>
</task>

<task type="auto">
  <name>Task 2: Remove JS from vite static-copy config</name>
  <files>vite.config.ts</files>
  <action>
In the viteStaticCopy plugin targets array, remove the JS directory entry:
- Remove: `{ src: 'js', dest: '.' },`
- Keep: `{ src: 'css', dest: '.' }` - still needed for CSS files

The targets array should contain only the CSS entry after modification.
  </action>
  <verify>grep -c "src: 'js'" vite.config.ts returns 0 AND npm run build succeeds</verify>
  <done>vite.config.ts no longer copies js/ directory to dist/, build passes</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] No js/*.js references in index.html
- [ ] No js directory in vite static-copy targets
- [ ] `npm run build` succeeds without errors
- [ ] App still loads (legacy JS no longer needed)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No build errors introduced
- HTML and build config cleaned of legacy JS references
</success_criteria>

<output>
After completion, create `.planning/phases/17-remove-legacy-files/17-01-SUMMARY.md`
</output>
