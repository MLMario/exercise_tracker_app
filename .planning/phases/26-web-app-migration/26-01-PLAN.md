---
phase: 26-web-app-migration
plan: 01
type: execute
depends_on: []
files_modified:
  - apps/web/package.json
  - apps/web/tsconfig.json
  - apps/web/index.html
  - apps/web/vite.config.ts
  - apps/web/src/main.tsx
  - apps/web/src/env.d.ts
  - apps/web/src/components/*
  - apps/web/src/surfaces/*
  - apps/web/css/styles.css
  - apps/web/assets/bell.mp3
---

<objective>
Move web app files from root to apps/web/ monorepo structure.

Purpose: Complete the monorepo restructure by relocating web-specific code to its own app directory, leaving root clean for workspace management only.
Output: Fully functional apps/web/ containing all web app code, preserving git history via git mv.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-extract-shared-package/25-01-SUMMARY.md

**Current state (post Phase 25):**
- packages/shared/ contains: types/, services/, lib/ (already extracted)
- src/ contains only: components/, surfaces/, main.tsx, env.d.ts (web-specific)
- Root has: css/, assets/, index.html, vite.config.ts (web-specific)
- apps/ exists with just .gitkeep placeholder

**Target state:**
```
apps/web/
├── package.json         # Web app package
├── tsconfig.json        # Web-specific TS config
├── vite.config.ts       # Vite config (moved)
├── index.html           # Entry HTML (moved)
├── src/
│   ├── main.tsx         # App entry (moved)
│   ├── env.d.ts         # Vite env types (moved)
│   ├── components/      # Shared UI components (moved)
│   └── surfaces/        # Surface modules (moved)
├── css/
│   └── styles.css       # Styles (moved)
└── assets/
    └── bell.mp3         # Audio asset (moved)
```
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create web app package structure</name>
  <files>apps/web/package.json, apps/web/tsconfig.json</files>
  <action>
Create apps/web/ directory structure with package.json and tsconfig.json.

**package.json:**
- name: "@ironlift/web"
- private: true
- type: "module"
- scripts: dev, build, preview (same as current root)
- dependencies: preact, @preact/preset-vite, chart.js, alpinejs
- devDependencies: typescript, vite, vite-plugin-static-copy
- Add workspace dependency: "@ironlift/shared": "workspace:*"

**tsconfig.json:**
- extends: "../../tsconfig.json" (inherit root config)
- compilerOptions.baseUrl: "."
- compilerOptions.paths: { "@/*": ["./src/*"] }
- include: ["src/**/*", "vite.config.ts"]
- exclude: ["node_modules", "dist"]
  </action>
  <verify>cat apps/web/package.json && cat apps/web/tsconfig.json</verify>
  <done>apps/web/package.json and tsconfig.json exist with correct configuration</done>
</task>

<task type="auto">
  <name>Task 2: Move web app source files</name>
  <files>apps/web/src/*, apps/web/css/*, apps/web/assets/*, apps/web/index.html, apps/web/vite.config.ts</files>
  <action>
Use git mv to preserve history when moving files to apps/web/.

**Moves (in order):**
1. `git mv src/components apps/web/src/components`
2. `git mv src/surfaces apps/web/src/surfaces`
3. `git mv src/main.tsx apps/web/src/main.tsx`
4. `git mv src/env.d.ts apps/web/src/env.d.ts`
5. `git mv css apps/web/css`
6. `git mv assets apps/web/assets`
7. `git mv index.html apps/web/index.html`
8. `git mv vite.config.ts apps/web/vite.config.ts`

**Cleanup:**
- Remove now-empty src/ directory
- Remove apps/.gitkeep (no longer needed)

Do NOT update any imports yet - that's Phase 27.
  </action>
  <verify>ls -la apps/web/src/ && ls -la apps/web/css/ && ls -la apps/web/assets/ && test -f apps/web/index.html && test -f apps/web/vite.config.ts</verify>
  <done>All web files moved to apps/web/, src/ directory removed, git history preserved</done>
</task>

<task type="auto">
  <name>Task 3: Update root configs for monorepo</name>
  <files>package.json, tsconfig.json</files>
  <action>
Update root package.json and tsconfig.json for monorepo workspace management.

**Root package.json updates:**
- Remove dev/build/preview scripts (now in apps/web)
- Add workspace scripts:
  - "dev": "pnpm --filter @ironlift/web dev"
  - "build": "pnpm --filter @ironlift/web build"
  - "preview": "pnpm --filter @ironlift/web preview"
- Move dependencies to apps/web/package.json (preact, chart.js, etc.)
- Keep only workspace-level devDependencies if any

**Root tsconfig.json updates:**
- Remove paths (now in apps/web/tsconfig.json)
- Remove include/exclude (will be per-package)
- Keep compilerOptions that are shared across all packages
- Add references to packages/shared and apps/web
  </action>
  <verify>cat package.json && cat tsconfig.json && pnpm install</verify>
  <done>Root configs updated for workspace management, pnpm install succeeds</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] apps/web/ directory exists with full structure
- [ ] `ls apps/web/src/` shows components/, surfaces/, main.tsx, env.d.ts
- [ ] `ls apps/web/css/` shows styles.css
- [ ] `ls apps/web/assets/` shows bell.mp3
- [ ] apps/web/index.html exists
- [ ] apps/web/vite.config.ts exists
- [ ] Root src/ directory is removed
- [ ] `pnpm install` succeeds
- [ ] `git status` shows renamed files (history preserved)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Web app files relocated to apps/web/
- Root package.json configured for workspace scripts
- Git history preserved via git mv
- pnpm install succeeds (dependencies resolve)
</success_criteria>

<output>
After completion, create `.planning/phases/26-web-app-migration/26-01-SUMMARY.md`:

# Phase 26 Plan 01: Web App Migration Summary

**[Substantive one-liner - what shipped]**

## Performance

- **Duration:** X min
- **Tasks:** 3
- **Files modified:** N

## Accomplishments

- Created apps/web/ package structure
- Moved all web-specific code from root to apps/web/
- Updated root configs for workspace management

## Task Commits

Each task committed atomically:

1. **Task 1: Create web app package structure** - `hash` (feat)
2. **Task 2: Move web app source files** - `hash` (refactor)
3. **Task 3: Update root configs for monorepo** - `hash` (chore)

## Files Created/Modified

**Created:**
- apps/web/package.json
- apps/web/tsconfig.json

**Moved (git mv):**
- src/components/ → apps/web/src/components/
- src/surfaces/ → apps/web/src/surfaces/
- src/main.tsx → apps/web/src/main.tsx
- src/env.d.ts → apps/web/src/env.d.ts
- css/ → apps/web/css/
- assets/ → apps/web/assets/
- index.html → apps/web/index.html
- vite.config.ts → apps/web/vite.config.ts

**Deleted:**
- src/ (empty directory)
- apps/.gitkeep

**Modified:**
- package.json (workspace scripts)
- tsconfig.json (project references)

## Deviations from Plan

None / [Describe any deviations]

## Decisions Made

None - followed plan as specified.

## Issues Encountered

None / [Describe any issues]

## Next Phase Readiness

Ready for Phase 27: Update Imports
- apps/web/ contains all web-specific code
- Import paths still use @/ aliases (will break until Phase 27)
- Need to update imports to use @ironlift/shared
</output>
